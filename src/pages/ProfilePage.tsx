// ... (전체 파일 내용이 너무 길어서 핵심 부분만 수정)