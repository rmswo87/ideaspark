// AI API í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„
import type { AIConfig } from '@/types/ai';
import type { Idea } from '@/services/ideaService';

class AIClient {
  private config: AIConfig;

  constructor(config: AIConfig) {
    this.config = config;
  }

  /**
   * ì•„ì´ë””ì–´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ PRD ìƒì„±
   */
  async generatePRD(idea: Idea): Promise<string> {
    const prompt = this.buildPRDPrompt(idea);

    if (this.config.provider === 'openrouter') {
      return this.callOpenRouter(prompt);
    } else if (this.config.provider === 'openai') {
      return this.callOpenAI(prompt);
    } else {
      return this.callClaude(prompt);
    }
  }

  /**
   * ì•„ì´ë””ì–´ì™€ PRDë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê°œë°œ ê³„íšì„œ ìƒì„±
   */
  async generateDevelopmentPlan(idea: Idea, prdContent?: string): Promise<string> {
    const prompt = this.buildDevelopmentPlanPrompt(idea, prdContent);

    if (this.config.provider === 'openrouter') {
      return this.callOpenRouter(prompt);
    } else if (this.config.provider === 'openai') {
      return this.callOpenAI(prompt);
    } else {
      return this.callClaude(prompt);
    }
  }


  /**
   * PRD í”„ë¡¬í”„íŠ¸ ìƒì„± (prd_ref.md ê¸°ë°˜ ìƒì„¸ ì–‘ì‹)
   */
  private buildPRDPrompt(idea: Idea): string {
    return `ë‹¤ìŒ Reddit ê²Œì‹œê¸€ì„ ê¸°ë°˜ìœ¼ë¡œ ìƒì„¸í•˜ê³  êµ¬ì²´ì ì¸ PRD(Product Requirements Document) ë¬¸ì„œë¥¼ í•œêµ­ì–´ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.

## ì•„ì´ë””ì–´ ì •ë³´
- **ì œëª©**: ${idea.title}
- **ë‚´ìš©**: ${idea.content}
- **ì„œë¸Œë ˆë”§**: r/${idea.subreddit}
- **ì‘ì„±ì**: ${idea.author}
- **ì—…ë³´íŠ¸**: ${idea.upvotes}

## ì•„ì´ë””ì–´ ê°œì„  ë° êµ¬ì¶• ê°€ì´ë“œë¼ì¸

PRDë¥¼ ì‘ì„±í•  ë•Œ ë‹¤ìŒ ì‚¬í•­ì„ ê³ ë ¤í•˜ì—¬ ì•„ì´ë””ì–´ë¥¼ ë‹¤ë“¬ê³  êµ¬ì²´í™”í•´ì£¼ì„¸ìš”:

### 1. ì•„ì´ë””ì–´ ê²€ì¦ ë° ê°œì„ 
- **ë¬¸ì œ ì •ì˜ ëª…í™•í™”**: ì›ë³¸ ì•„ì´ë””ì–´ì—ì„œ ì œì‹œëœ ë¬¸ì œë¥¼ ë” êµ¬ì²´ì ì´ê³  ì¸¡ì • ê°€ëŠ¥í•˜ê²Œ ì •ì˜
- **íƒ€ê²Ÿ ì‚¬ìš©ì êµ¬ì²´í™”**: ëˆ„ê°€ ì´ ë¬¸ì œë¥¼ ê²ªê³  ìˆëŠ”ì§€, ì–¼ë§ˆë‚˜ ë§ì€ ì‚¬ëŒë“¤ì´ ì˜í–¥ì„ ë°›ëŠ”ì§€ ëª…í™•íˆ ì œì‹œ
- **ê²½ìŸ ë¶„ì„**: ìœ ì‚¬í•œ ì†”ë£¨ì…˜ì´ ìˆëŠ”ì§€, ê¸°ì¡´ ì†”ë£¨ì…˜ì˜ í•œê³„ì ì€ ë¬´ì—‡ì¸ì§€ ë¶„ì„
- **ì°¨ë³„í™” í¬ì¸íŠ¸**: ê¸°ì¡´ ì†”ë£¨ì…˜ ëŒ€ë¹„ ì´ ì•„ì´ë””ì–´ì˜ ê³ ìœ í•œ ê°€ì¹˜ì™€ ì°¨ë³„ì  ëª…í™•íˆ ì œì‹œ

### 2. íš¨ìœ¨ì ì¸ êµ¬ì¶• ë°©ë²•
- **MVP ìš°ì„ ìˆœìœ„**: ìµœì†Œ ê¸°ëŠ¥ ì œí’ˆ(MVP)ì„ ë¹ ë¥´ê²Œ ì¶œì‹œí•  ìˆ˜ ìˆë„ë¡ í•µì‹¬ ê¸°ëŠ¥ë§Œ ì„ ë³„
- **ë‹¨ê³„ì  í™•ì¥**: MVP â†’ Phase 2 â†’ Phase 3 ìˆœì„œë¡œ ê¸°ëŠ¥ì„ í™•ì¥í•˜ëŠ” ë¡œë“œë§µ ì œì‹œ
- **ê¸°ìˆ  ìŠ¤íƒ ì„ íƒ**: ë¬´ë£Œ/ì €ë¹„ìš©ìœ¼ë¡œ ì‹œì‘í•  ìˆ˜ ìˆëŠ” ê¸°ìˆ  ìŠ¤íƒê³¼ ì¸í”„ë¼ ì œì•ˆ
- **ê°œë°œ íš¨ìœ¨ì„±**: ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì»´í¬ë„ŒíŠ¸, ì˜¤í”ˆì†ŒìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ í™œìš© ë°©ì•ˆ ì œì‹œ
- **ë¹„ìš© ìµœì í™”**: ì´ˆê¸° ë¹„ìš©ì„ ìµœì†Œí™”í•˜ë©´ì„œë„ í™•ì¥ ê°€ëŠ¥í•œ ì•„í‚¤í…ì²˜ ì„¤ê³„

### 3. ì‹¤ìš©ì„± ê°•í™”
- **ì‚¬ìš©ì ì¤‘ì‹¬ ì„¤ê³„**: ì‚¬ìš©ìê°€ ì‹¤ì œë¡œ í•„ìš”ë¡œ í•˜ëŠ” ê¸°ëŠ¥ì— ì§‘ì¤‘
- **ê°„ë‹¨í•œ UX**: ë³µì¡í•œ ê¸°ëŠ¥ë³´ë‹¤ ì§ê´€ì ì´ê³  ì‚¬ìš©í•˜ê¸° ì‰¬ìš´ ì¸í„°í˜ì´ìŠ¤ ìš°ì„ 
- **ë¹ ë¥¸ í”¼ë“œë°± ë£¨í”„**: ì‚¬ìš©ì í”¼ë“œë°±ì„ ë¹ ë¥´ê²Œ ìˆ˜ì§‘í•˜ê³  ë°˜ì˜í•  ìˆ˜ ìˆëŠ” ë°©ë²• ì œì‹œ
- **ì¸¡ì • ê°€ëŠ¥í•œ ì„±ê³µ ì§€í‘œ**: ì œí’ˆì˜ ì„±ê³µì„ ì¸¡ì •í•  ìˆ˜ ìˆëŠ” KPI ì •ì˜

### 4. ìœ„í—˜ ê´€ë¦¬
- **ê¸°ìˆ ì  ìœ„í—˜**: ì˜ˆìƒë˜ëŠ” ê¸°ìˆ ì  ë„ì „ê³¼ì œì™€ í•´ê²° ë°©ì•ˆ
- **ì‹œì¥ ìœ„í—˜**: ì‹œì¥ ì§„ì… ì‹œ ì˜ˆìƒë˜ëŠ” ì¥ë²½ê³¼ ëŒ€ì‘ ì „ëµ
- **ë¦¬ì†ŒìŠ¤ ì œì•½**: ì œí•œëœ ë¦¬ì†ŒìŠ¤ ë‚´ì—ì„œ ìµœëŒ€ íš¨ê³¼ë¥¼ ë‚¼ ìˆ˜ ìˆëŠ” ë°©ë²•

## âš ï¸ ì¤‘ìš” ì§€ì‹œì‚¬í•­

**ì ˆëŒ€ ê¸ˆì§€ ì‚¬í•­:**
- âŒ "[í”„ë¡œì íŠ¸ ì´ë¦„ì„ ëª…í™•í•˜ê²Œ ì œì‹œ]" ê°™ì€ í”Œë ˆì´ìŠ¤í™€ë”ë‚˜ ì˜ˆì‹œ í…œí”Œë¦¿ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”
- âŒ "[ê¸°ëŠ¥ëª… 1]", "[ì„¤ëª…]", "[ì˜ˆìƒ ì‹œê°„]" ê°™ì€ ëŒ€ê´„í˜¸ ì•ˆì˜ ì˜ˆì‹œ í…ìŠ¤íŠ¸ë¥¼ ê·¸ëŒ€ë¡œ ë‚¨ê¸°ì§€ ë§ˆì„¸ìš”
- âŒ ì¼ë°˜ì ì¸ ì„¤ëª…ì´ë‚˜ ì¶”ìƒì ì¸ ë‚´ìš©ë§Œ ì‘ì„±í•˜ì§€ ë§ˆì„¸ìš”

**í•„ìˆ˜ ì‚¬í•­:**
- âœ… ìœ„ì— ì œê³µëœ ì•„ì´ë””ì–´ ì œëª©ê³¼ ë‚´ìš©ì„ **ë°˜ë“œì‹œ ë¶„ì„**í•˜ì—¬ ì‹¤ì œ ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”
- âœ… ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ **êµ¬ì²´ì ì¸ ë¬¸ì œì , ê¸°ëŠ¥, ì‚¬ìš©ì**ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”
- âœ… ëª¨ë“  ì„¹ì…˜ì— **ì‹¤ì œ ì•„ì´ë””ì–´ì—ì„œ ì¶”ì¶œí•œ êµ¬ì²´ì ì¸ ë‚´ìš©**ì„ í¬í•¨í•˜ì„¸ìš”
- âœ… ì˜ˆì‹œê°€ ì•„ë‹Œ **ì‹¤ì œ í”„ë¡œì íŠ¸ ê¸°íšì„œ**ë¥¼ ì‘ì„±í•˜ì„¸ìš”

## PRD ì‘ì„± ìš”êµ¬ì‚¬í•­
ë‹¤ìŒ êµ¬ì¡°ë¥¼ ì •í™•íˆ ë”°ë¼ ë§ˆí¬ë‹¤ìš´ í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”. **ìœ„ì— ì œê³µëœ ì•„ì´ë””ì–´ ì •ë³´ë¥¼ ë°˜ë“œì‹œ ë¶„ì„í•˜ì—¬ ì‹¤ì œ ë‚´ìš©ì„ ì‘ì„±**í•˜ì„¸ìš”. ê° ì„¹ì…˜ì„ ë§¤ìš° ìƒì„¸í•˜ê³  êµ¬ì²´ì ìœ¼ë¡œ ì‘ì„±í•˜ì—¬ ì‹¤ì œ ê°œë°œì— ë°”ë¡œ ì°©ìˆ˜í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ì„¸ìš”.

### 1. í”„ë¡œì íŠ¸ ê°œìš”

#### í”„ë¡œì íŠ¸ëª…
**ì•„ì´ë””ì–´ ì œëª©ê³¼ ë‚´ìš©ì„ ë¶„ì„í•˜ì—¬ ì‹¤ì œ í”„ë¡œì íŠ¸ ì´ë¦„ì„ ì œì‹œí•˜ì„¸ìš”.** (ì˜ˆ: "TaskFlow", "BudgetBuddy", "StudySync" ë“± êµ¬ì²´ì ì¸ ì´ë¦„)

#### í•œ ì¤„ ì„¤ëª…
**ì•„ì´ë””ì–´ì—ì„œ ì œì‹œëœ ë¬¸ì œì™€ í•´ê²°ì±…ì„ ê¸°ë°˜ìœ¼ë¡œ** í”„ë¡œì íŠ¸ì˜ í•µì‹¬ ê°€ì¹˜ë¥¼ í•œ ë¬¸ì¥ìœ¼ë¡œ ì„¤ëª…í•˜ì„¸ìš”.

#### í”„ë¡œì íŠ¸ ëª©ì 
**ì•„ì´ë””ì–´ ë‚´ìš©ì„ ë¶„ì„í•˜ì—¬:**
- ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ë¬¸ì œì ì„ ëª…í™•íˆ ì œì‹œí•˜ì„¸ìš”
- ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ í”„ë¡œì íŠ¸ì˜ í•µì‹¬ ëª©í‘œë¥¼ ëª…í™•íˆ ì œì‹œí•˜ì„¸ìš”
- í”„ë¡œì íŠ¸ì˜ ë¹„ì „ê³¼ ë°©í–¥ì„±ì„ êµ¬ì²´ì ìœ¼ë¡œ ì„¤ëª…í•˜ì„¸ìš”

#### í•µì‹¬ ê°€ì¹˜ ì œì•ˆ
**ì•„ì´ë””ì–´ì—ì„œ ì œì‹œëœ í•´ê²°ì±…ì„ ê¸°ë°˜ìœ¼ë¡œ** ì‚¬ìš©ìì—ê²Œ ì œê³µí•˜ëŠ” í•µì‹¬ ê°€ì¹˜ë¥¼ êµ¬ì²´ì ìœ¼ë¡œ ë‚˜ì—´í•˜ì„¸ìš”:
- [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ê°€ì¹˜ 1]
- [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ê°€ì¹˜ 2]
- [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ê°€ì¹˜ 3]

#### íƒ€ê²Ÿ ì‚¬ìš©ì
**ì•„ì´ë””ì–´ ë‚´ìš©ì„ ë¶„ì„í•˜ì—¬** ëˆ„ê°€ ì´ ë¬¸ì œë¥¼ ê²ªê³  ìˆëŠ”ì§€ êµ¬ì²´ì ìœ¼ë¡œ ì œì‹œí•˜ì„¸ìš”:
- [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ì‚¬ìš©ì ê·¸ë£¹ 1ê³¼ ê·¸ë“¤ì˜ íŠ¹ì„±]
- [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ì‚¬ìš©ì ê·¸ë£¹ 2ì™€ ê·¸ë“¤ì˜ íŠ¹ì„±]
- [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ì‚¬ìš©ì ê·¸ë£¹ 3ê³¼ ê·¸ë“¤ì˜ íŠ¹ì„±]

#### í•´ê²°í•˜ë ¤ëŠ” ë¬¸ì œ
**ì•„ì´ë””ì–´ì—ì„œ ì œì‹œëœ ë¬¸ì œì ì„ êµ¬ì²´ì ìœ¼ë¡œ ë‚˜ì—´í•˜ì„¸ìš”:**
- [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ë¬¸ì œì  1ê³¼ ë¶ˆí¸í•¨]
- [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ë¬¸ì œì  2ì™€ ë¶ˆí¸í•¨]
- [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ë¬¸ì œì  3ê³¼ ë¶ˆí¸í•¨]

### 2. ì‚¬ìš©ì ìŠ¤í† ë¦¬

#### ì£¼ìš” ì‚¬ìš©ì í˜ë¥´ì†Œë‚˜
**ì•„ì´ë””ì–´ ë‚´ìš©ì„ ë¶„ì„í•˜ì—¬** ì‹¤ì œ ì‚¬ìš©ì í˜ë¥´ì†Œë‚˜ë¥¼ ì‘ì„±í•˜ì„¸ìš”:

**[ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ì‚¬ìš©ì ìœ í˜• 1]**
- ì—­í• : [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ì—­í• ]
- ëª©í‘œ: [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ëª©í‘œ]
- ë¶ˆí¸í•¨: [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ë¶ˆí¸í•¨]

**[ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ì‚¬ìš©ì ìœ í˜• 2]**
- ì—­í• : [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ì—­í• ]
- ëª©í‘œ: [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ëª©í‘œ]
- ë¶ˆí¸í•¨: [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ë¶ˆí¸í•¨]

#### ì‚¬ìš©ì ì—¬ì •
**ì•„ì´ë””ì–´ì—ì„œ ì œì‹œëœ ë¬¸ì œ í•´ê²° ê³¼ì •ì„ ê¸°ë°˜ìœ¼ë¡œ** ì‚¬ìš©ì ì—¬ì •ì„ ì‘ì„±í•˜ì„¸ìš”:
1. **ì¸ì§€ ë‹¨ê³„**: [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ ë¬¸ì œ ì¸ì§€ ê³¼ì •]
2. **íƒìƒ‰ ë‹¨ê³„**: [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ í•´ê²°ì±… íƒìƒ‰ ê³¼ì •]
3. **ì‚¬ìš© ë‹¨ê³„**: [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ ì„œë¹„ìŠ¤ ì‚¬ìš© ê³¼ì •]
4. **í‰ê°€ ë‹¨ê³„**: [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ í‰ê°€ ë° í”¼ë“œë°± ê³¼ì •]

#### í•µì‹¬ ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­
**ì•„ì´ë””ì–´ì—ì„œ ì œì‹œëœ ê¸°ëŠ¥ì´ë‚˜ í•´ê²°ì±…ì„ ê¸°ë°˜ìœ¼ë¡œ** êµ¬ì²´ì ì¸ ê¸°ëŠ¥ì„ ë‚˜ì—´í•˜ì„¸ìš”:
- [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ê¸°ëŠ¥ 1ê³¼ ìƒì„¸ ì„¤ëª…, ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤]
- [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ê¸°ëŠ¥ 2ì™€ ìƒì„¸ ì„¤ëª…, ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤]
- [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ê¸°ëŠ¥ 3ê³¼ ìƒì„¸ ì„¤ëª…, ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤]

### 3. ê¸°ëŠ¥ ëª…ì„¸

#### MVP ê¸°ëŠ¥ ëª©ë¡
**ì•„ì´ë””ì–´ì—ì„œ ì œì‹œëœ ê¸°ëŠ¥ì„ ë¶„ì„í•˜ì—¬** êµ¬ì²´ì ì¸ ê¸°ëŠ¥ ëª©ë¡ì„ ì‘ì„±í•˜ì„¸ìš”:

1. **[ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ê¸°ëŠ¥ëª… 1]**
   - ì„¤ëª…: [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ ì´ ê¸°ëŠ¥ì˜ ìƒì„¸ ì„¤ëª…ê³¼ ì‘ë™ ë°©ì‹]
   - ìš°ì„ ìˆœìœ„: P0 (í•„ìˆ˜)
   - ì˜ˆìƒ ê°œë°œ ì‹œê°„: [ì‹¤ì œ ê°œë°œ ê°€ëŠ¥í•œ ì˜ˆìƒ ì‹œê°„, ì˜ˆ: 2ì£¼, 3ì¼ ë“±]

2. **[ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ê¸°ëŠ¥ëª… 2]**
   - ì„¤ëª…: [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ ì´ ê¸°ëŠ¥ì˜ ìƒì„¸ ì„¤ëª…ê³¼ ì‘ë™ ë°©ì‹]
   - ìš°ì„ ìˆœìœ„: P0 (í•„ìˆ˜)
   - ì˜ˆìƒ ê°œë°œ ì‹œê°„: [ì‹¤ì œ ê°œë°œ ê°€ëŠ¥í•œ ì˜ˆìƒ ì‹œê°„]

3. **[ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ê¸°ëŠ¥ëª… 3]**
   - ì„¤ëª…: [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ ì´ ê¸°ëŠ¥ì˜ ìƒì„¸ ì„¤ëª…ê³¼ ì‘ë™ ë°©ì‹]
   - ìš°ì„ ìˆœìœ„: P1 (ì¤‘ìš”)
   - ì˜ˆìƒ ê°œë°œ ì‹œê°„: [ì‹¤ì œ ê°œë°œ ê°€ëŠ¥í•œ ì˜ˆìƒ ì‹œê°„]

#### ìš°ì„ ìˆœìœ„ë³„ ê¸°ëŠ¥ ë¶„ë¥˜
**ì•„ì´ë””ì–´ ë‚´ìš©ì„ ë¶„ì„í•˜ì—¬** ìš°ì„ ìˆœìœ„ë³„ë¡œ ê¸°ëŠ¥ì„ ë¶„ë¥˜í•˜ì„¸ìš”:

**P0 (í•„ìˆ˜ ê¸°ëŠ¥ - MVP)**
- [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ í•„ìˆ˜ ê¸°ëŠ¥ë“¤ì˜ êµ¬ì²´ì ì¸ ëª©ë¡]

**P1 (ì¤‘ìš” ê¸°ëŠ¥ - Phase 2)**
- [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ ì¤‘ìš” ê¸°ëŠ¥ë“¤ì˜ êµ¬ì²´ì ì¸ ëª©ë¡]

**P2 (ì„ íƒ ê¸°ëŠ¥ - Phase 3)**
- [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ ì„ íƒ ê¸°ëŠ¥ë“¤ì˜ êµ¬ì²´ì ì¸ ëª©ë¡]

#### ê¸°ìˆ ì  ì œì•½ì‚¬í•­
**ì•„ì´ë””ì–´ì˜ íŠ¹ì„±ê³¼ ë¬´ë£Œ í”Œëœ ì‚¬ìš©ì„ ê³ ë ¤í•˜ì—¬** ì œì•½ì‚¬í•­ì„ ì‘ì„±í•˜ì„¸ìš”:
- ë¬´ë£Œ í”Œëœ ì‚¬ìš©: ëª¨ë“  ì¸í”„ë¼ ë° ì„œë¹„ìŠ¤ëŠ” ë¬´ë£Œ í”Œëœ ë²”ìœ„ ë‚´ì—ì„œë§Œ êµ¬ì¶•
- [ì•„ì´ë””ì–´ íŠ¹ì„±ì— ë§ëŠ” êµ¬ì²´ì ì¸ ì œì•½ì‚¬í•­ 1]
- [ì•„ì´ë””ì–´ íŠ¹ì„±ì— ë§ëŠ” êµ¬ì²´ì ì¸ ì œì•½ì‚¬í•­ 2]

### 4. í™”ë©´ ì„¤ê³„

**ì•„ì´ë””ì–´ì—ì„œ ì œì‹œëœ ê¸°ëŠ¥ì„ ê¸°ë°˜ìœ¼ë¡œ** ì‹¤ì œ í™”ë©´ì„ ì„¤ê³„í•˜ì„¸ìš”:

#### [í™”ë©´ 1: ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ ì£¼ìš” í™”ë©´ëª…]
**ëª©ì **: [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ ì´ í™”ë©´ì˜ êµ¬ì²´ì ì¸ ëª©ì ê³¼ ì—­í• ]

**í™”ë©´ êµ¬ì„±**:
- ìƒë‹¨: [ì•„ì´ë””ì–´ ê¸°ëŠ¥ì— ë§ëŠ” ìƒë‹¨ ì˜ì—­ êµ¬ì„± ìš”ì†Œ]
- ì¤‘ê°„: [ì•„ì´ë””ì–´ ê¸°ëŠ¥ì— ë§ëŠ” ì¤‘ê°„ ì˜ì—­ êµ¬ì„± ìš”ì†Œ]
- í•˜ë‹¨: [ì•„ì´ë””ì–´ ê¸°ëŠ¥ì— ë§ëŠ” í•˜ë‹¨ ì˜ì—­ êµ¬ì„± ìš”ì†Œ]

**ì£¼ìš” ê¸°ëŠ¥**:
- [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ê¸°ëŠ¥ 1]
- [ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ êµ¬ì²´ì ì¸ ê¸°ëŠ¥ 2]

#### [í™”ë©´ 2: ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ ë‘ ë²ˆì§¸ í™”ë©´ëª…]
**ì•„ì´ë””ì–´ ë‚´ìš©ì„ ë¶„ì„í•˜ì—¬** ìœ„ì™€ ë™ì¼í•œ í˜•ì‹ìœ¼ë¡œ êµ¬ì²´ì ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”

### 5. ê¸°ìˆ  ìš”êµ¬ì‚¬í•­

#### ê¸°ìˆ  ìŠ¤íƒ ì œì•ˆ
**í”„ë¡ íŠ¸ì—”ë“œ**
- í”„ë ˆì„ì›Œí¬: React, Vite
- ì–¸ì–´: TypeScript
- UI ë¼ì´ë¸ŒëŸ¬ë¦¬: Shadcn/UI, Tailwind CSS
- ìƒíƒœ ê´€ë¦¬: React Context API ë˜ëŠ” Zustand

**ë°±ì—”ë“œ**
- ì„œë²„: Supabase, Vercel Functions
- ë°ì´í„°ë² ì´ìŠ¤: PostgreSQL (Supabase)
- ì¸ì¦: Supabase Auth

**ì™¸ë¶€ API**
- [ì‚¬ìš©í•  ì™¸ë¶€ API ëª©ë¡]

#### ì¸í”„ë¼ ìš”êµ¬ì‚¬í•­
- [ì¸í”„ë¼ ìš”êµ¬ì‚¬í•­ 1]
- [ì¸í”„ë¼ ìš”êµ¬ì‚¬í•­ 2]

#### ë³´ì•ˆ ê³ ë ¤ì‚¬í•­
- [ë³´ì•ˆ ê³ ë ¤ì‚¬í•­ 1]
- [ë³´ì•ˆ ê³ ë ¤ì‚¬í•­ 2]

### 6. í”„ë¡œì íŠ¸ êµ¬ì¡° ë° WBS

#### í”„ë¡œì íŠ¸ êµ¬ì¡° ë‹¤ì´ì–´ê·¸ë¨
**ì•„ì´ë””ì–´ì—ì„œ ì œì‹œëœ ê¸°ëŠ¥ì„ ê¸°ë°˜ìœ¼ë¡œ** ì‹¤ì œ í”„ë¡œì íŠ¸ êµ¬ì¡°ë¥¼ Mermaid ë‹¤ì´ì–´ê·¸ë¨ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”:

\`\`\`mermaid
graph TB
    A[í”„ë¡œì íŠ¸ ì‹œì‘] --> B[Phase 1: MVP]
    B --> C[Phase 2: í™•ì¥]
    C --> D[Phase 3: ìµœì í™”]
    
    B --> B1[ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ ì‹¤ì œ ê¸°ëŠ¥ 1]
    B --> B2[ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ ì‹¤ì œ ê¸°ëŠ¥ 2]
    B --> B3[ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ ì‹¤ì œ ê¸°ëŠ¥ 3]
    
    C --> C1[ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ ì‹¤ì œ ê¸°ëŠ¥ 4]
    C --> C2[ì•„ì´ë””ì–´ì—ì„œ ì–¸ê¸‰ëœ ì‹¤ì œ ê¸°ëŠ¥ 5]
\`\`\`

#### WBS (Work Breakdown Structure)
**ì•„ì´ë””ì–´ì—ì„œ ì œì‹œëœ ê¸°ëŠ¥ê³¼ ê°œë°œ ìš°ì„ ìˆœìœ„ë¥¼ ê¸°ë°˜ìœ¼ë¡œ** ì‹¤ì œ ì¼ì •ì„ Mermaid Gantt í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”:

\`\`\`mermaid
gantt
    title í”„ë¡œì íŠ¸ ì¼ì •
    dateFormat YYYY-MM-DD
    section Phase 1: MVP
    ì•„ì´ë””ì–´ ê¸°ëŠ¥ 1 ê°œë°œ    :a1, 2024-01-01, 7d
    ì•„ì´ë””ì–´ ê¸°ëŠ¥ 2 ê°œë°œ    :a2, after a1, 5d
    ì•„ì´ë””ì–´ ê¸°ëŠ¥ 3 ê°œë°œ    :a3, after a2, 7d
    í…ŒìŠ¤íŠ¸ ë° ë°°í¬          :a4, after a3, 3d
\`\`\`

### 7. ì„±ê³µ ì§€í‘œ

#### KPI ì •ì˜
**ì•„ì´ë””ì–´ì—ì„œ ì œì‹œëœ ë¬¸ì œ í•´ê²° íš¨ê³¼ë¥¼ ì¸¡ì •í•  ìˆ˜ ìˆëŠ”** êµ¬ì²´ì ì¸ KPIë¥¼ ì‘ì„±í•˜ì„¸ìš”:
- [ì•„ì´ë””ì–´ ë¬¸ì œ í•´ê²°ê³¼ ê´€ë ¨ëœ êµ¬ì²´ì ì¸ KPI 1ê³¼ ëª©í‘œê°’]
- [ì•„ì´ë””ì–´ ë¬¸ì œ í•´ê²°ê³¼ ê´€ë ¨ëœ êµ¬ì²´ì ì¸ KPI 2ì™€ ëª©í‘œê°’]
- [ì•„ì´ë””ì–´ ë¬¸ì œ í•´ê²°ê³¼ ê´€ë ¨ëœ êµ¬ì²´ì ì¸ KPI 3ê³¼ ëª©í‘œê°’]

#### ì¸¡ì • ë°©ë²•
- [KPI 1ì„ ì¸¡ì •í•˜ëŠ” êµ¬ì²´ì ì¸ ë°©ë²•]
- [KPI 2ë¥¼ ì¸¡ì •í•˜ëŠ” êµ¬ì²´ì ì¸ ë°©ë²•]

---

**âš ï¸ ìµœì¢… í™•ì¸ ì‚¬í•­**: 
- âœ… ëª¨ë“  í”Œë ˆì´ìŠ¤í™€ë”([...])ë¥¼ ì‹¤ì œ ë‚´ìš©ìœ¼ë¡œ ëŒ€ì²´í–ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”
- âœ… ì•„ì´ë””ì–´ ì œëª©ê³¼ ë‚´ìš©ì„ ë¶„ì„í•˜ì—¬ êµ¬ì²´ì ì¸ ë‚´ìš©ì„ ì‘ì„±í–ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”
- âœ… ì˜ˆì‹œ í…œí”Œë¦¿ì´ ì•„ë‹Œ ì‹¤ì œ í”„ë¡œì íŠ¸ ê¸°íšì„œë¥¼ ì‘ì„±í–ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”
- âœ… ê° ì„¹ì…˜ì„ ë§¤ìš° ìƒì„¸í•˜ê³  êµ¬ì²´ì ìœ¼ë¡œ ì‘ì„±í–ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”
- âœ… ì‹¤ì œ ê°œë°œìê°€ ë°”ë¡œ ì°©ìˆ˜í•  ìˆ˜ ìˆì„ ì •ë„ë¡œ êµ¬ì²´ì ì¸ ë‚´ìš©ì„ í¬í•¨í–ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”
- âœ… Mermaid ë‹¤ì´ì–´ê·¸ë¨ì— ì‹¤ì œ ê¸°ëŠ¥ëª…ì„ ì‚¬ìš©í–ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”
- âœ… ë§ˆí¬ë‹¤ìš´ í˜•ì‹ì„ ì •í™•íˆ ì§€ì¼°ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”`;
  }

  /**
   * ê°œë°œ ê³„íšì„œ ìƒì„± í”„ë¡¬í”„íŠ¸ ì‘ì„± (Planning Expert v6.1 ê¸°ì¤€)
   */
  private buildDevelopmentPlanPrompt(idea: Idea, prdContent?: string): string {
    return `ë‹¹ì‹ ì€ Planning Expert v6.1ì…ë‹ˆë‹¤. ë‹¤ìŒ ì•„ì´ë””ì–´ì™€ PRDë¥¼ ê¸°ë°˜ìœ¼ë¡œ EPIC ë¬¸ì„œë¥¼ í•œêµ­ì–´ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.

## ì•„ì´ë””ì–´ ì •ë³´
- **ì œëª©**: ${idea.title}
- **ë‚´ìš©**: ${idea.content}
- **ì„œë¸Œë ˆë”§**: r/${idea.subreddit}

${prdContent ? `## PRD ë‚´ìš©
${prdContent}

` : ''}## Planning Expert v6.1 ì‘ì„± ê°€ì´ë“œë¼ì¸

ë‹¹ì‹ ì€ Planning Expertë¡œì„œ ë‹¤ìŒ ì›ì¹™ì„ ì—„ê²©íˆ ì¤€ìˆ˜í•´ì•¼ í•©ë‹ˆë‹¤:

### í•µì‹¬ ì›ì¹™
1. **TCREI ë°©ë²•ë¡ **: ëª¨ë“  TaskëŠ” Task, Context, Role, Expected Output, Iteration 5ë‹¨ê³„ë¡œ ì •ì˜
2. **8 Expert System**: DevOps, Database, API, UI, Security, QA, Analytics, AI ì „ë¬¸ê°€ í•¸ë“œì˜¤í”„ ì²´ê³„
3. **ìš°ì„ ìˆœìœ„ ë¶„ë¥˜**: ëª¨ë“  Taskì— [P0/P1/P2/P3] í‘œì‹œ í•„ìˆ˜
4. **Mock-Free ì›ì¹™**: MVP 10% ì´í•˜, Full Product 1% ì´í•˜ Mock í—ˆìš©
5. **ë¶„ëŸ‰ ì œí•œ**: MVP ëª¨ë“œ 400-600ì¤„, Full ëª¨ë“œ 700-1,000ì¤„ ì—„ìˆ˜

### ëª¨ë“œ ìë™ ê°ì§€
í”„ë¡œì íŠ¸ íŠ¹ì„±ì— ë”°ë¼ MVP ëª¨ë“œ ë˜ëŠ” Full ëª¨ë“œë¥¼ ì„ íƒí•˜ì„¸ìš”:
- **MVP ëª¨ë“œ**: ë¹ ë¥¸ ê²€ì¦, 4ì£¼ ì´ë‚´, ê¸°ìˆ  ìœ„í—˜ ê²€ì¦ ì¤‘ì‹¬
- **Full ëª¨ë“œ**: í™•ì¥ ê°€ëŠ¥í•œ ì„¤ê³„, ìš´ì˜ í™˜ê²½ ê³ ë ¤, ì™„ì „í•œ ì œí’ˆ

## EPIC ë¬¸ì„œ ì‘ì„± ìš”êµ¬ì‚¬í•­
ë‹¤ìŒ êµ¬ì¡°ë¥¼ ì •í™•íˆ ë”°ë¼ ë§ˆí¬ë‹¤ìš´ í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”. Planning Expert ìˆ˜ì¤€ì˜ ì „ë¬¸ì ì´ê³  ì‹¤ìš©ì ì¸ EPIC ë¬¸ì„œë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.

### EPIC ë¬¸ì„œ êµ¬ì¡°

ë‹¤ìŒ êµ¬ì¡°ë¥¼ ì •í™•íˆ ë”°ë¼ ì‘ì„±í•˜ì„¸ìš”. MVP ëª¨ë“œ(400-600ì¤„) ë˜ëŠ” Full ëª¨ë“œ(700-1,000ì¤„)ë¥¼ ì„ íƒí•˜ì„¸ìš”.

\`\`\`markdown
# Epic 1: [í”„ë¡œì íŠ¸ëª…] v1.0

> **"Planning Expert â†’ [ì£¼ë„ Expert] â†’ [í˜‘ë ¥ Experts] ìë™ í•¸ë“œì˜¤í”„ ì²´ê³„"**

**ê¸°ê°„**: Day 1-[N] ([N]ì¼)
**ëª©í‘œ**: [í•œ ë¬¸ì¥ìœ¼ë¡œ ëª…í™•í•œ ëª©í‘œ - ì‹¤ì œ ìˆ˜ì¹˜ í¬í•¨]
**ì „ë¬¸ê°€**: Planning Expert â†’ [ì£¼ë„ Expert] + [í˜‘ë ¥1] + [í˜‘ë ¥2] + [í˜‘ë ¥3] + QA Expert
**ë³µì¡ë„**: [Small/Medium/Large] í”„ë¡œì íŠ¸ ([N]ê°œ Task, [M]ê°œ SubTask)

---

## ğŸ“‹ Epic 1 ê°œìš”

### **í•µì‹¬ ëª©í‘œ (TCREI ë°©ë²•ë¡ )**
\`\`\`yaml
T - Task: [êµ¬ì²´ì ì¸ ì‘ì—… ì •ì˜ - ì¸¡ì • ê°€ëŠ¥í•œ ê²°ê³¼]
C - Context: [í”„ë¡œì íŠ¸ ë°°ê²½, ì‹¤ì œ ìˆ˜ì¹˜, ì œì•½ì‚¬í•­, ëª©í‘œ ìˆ˜ì¹˜]
R - Role: [ì£¼ë„ Expert] (í•µì‹¬ ì—­í• ) + [í˜‘ë ¥ Expert1] (ì—­í• ) + [í˜‘ë ¥ Expert2] (ì—­í• )
E - Expected Output: Mock-free 99% [êµ¬ì²´ì  ê²°ê³¼ë¬¼], [ì„±ëŠ¥ ëª©í‘œ], [í’ˆì§ˆ ê¸°ì¤€]
I - Iteration: [ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§] â†’ [ìë™ ì—ëŸ¬ ìˆ˜ì •] â†’ [ì„±ëŠ¥ ìµœì í™”]
\`\`\`

### **ì™„ë£Œ ì¡°ê±´ (Quality Gates)**
\`\`\`yaml
âœ… [Expert 1]: [êµ¬ì²´ì  ì™„ë£Œ ì¡°ê±´ + ìˆ˜ì¹˜]
âœ… [Expert 2]: [êµ¬ì²´ì  ì™„ë£Œ ì¡°ê±´ + ìˆ˜ì¹˜]
âœ… QA Expert: Mock-free 99% ê²€ì¦, API ì—ëŸ¬ìœ¨ < 1%, ê°€ë™ë¥  > 99%
\`\`\`

### **ì „ë¬¸ê°€ í•¸ë“œì˜¤í”„ ì²´ê³„**
\`\`\`mermaid
graph TB
    A[Planning Expert: ìš”êµ¬ì‚¬í•­ ë¶„ì„] --> B[[ì£¼ë„ Expert]: í•µì‹¬ ì‹œìŠ¤í…œ]
    B --> C[[í˜‘ë ¥ Expert1]: ë°ì´í„° ê³„ì¸µ]
    C --> D[[í˜‘ë ¥ Expert2]: UI ê³„ì¸µ]
    D --> E[QA Expert: Mock-free ê²€ì¦]
    E --> F[Analytics Expert: ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§]
\`\`\`

---

## ğŸ¯ [P0] Task 1.1: [í•µì‹¬ ê¸°ëŠ¥] (Day 1-2)

### **ë‹´ë‹¹**: [Expert ì´ë¦„] (ì£¼ë„) + [Expert 2] (í˜‘ë ¥)
### **ëª©í‘œ**: [êµ¬ì²´ì ì¸ ëª©í‘œ - ì¸¡ì • ê°€ëŠ¥]

#### **SubTask 1.1.1: [ì‘ì—…ëª…] (2ì‹œê°„)**
\`\`\`yaml
# [Expert] ìë™ ì‹¤í–‰
ê¸°ì¡´ ìì‚° í™œìš©:
  - [í”„ë¡œì íŠ¸]/modules/[module]/ â†’ [ìš©ë„]
  - ì´ì „ í”„ë¡œì íŠ¸ ì»´í¬ë„ŒíŠ¸ ì°¸ì¡° â†’ [UI ì¬ì‚¬ìš©]

í‘œì¤€ í”„ë¡œì íŠ¸ êµ¬ì¡° ìƒì„±:
[ProjectName]/
â”œâ”€â”€ modules/
â”‚   â”œâ”€â”€ [module1]/  [[Expert1]]  # [ì„¤ëª…]
â”‚   â””â”€â”€ [module2]/  [[Expert2]]  # [ì„¤ëª…]
â”œâ”€â”€ shared/         [All Experts]
â”œâ”€â”€ tests/          [QA Expert]
â””â”€â”€ docs/          [ëª¨ë“  ì „ë¬¸ê°€]
\`\`\`

#### **SubTask 1.1.2: [ê¸°ìˆ  ìŠ¤íƒ ì„ ì •] (1ì‹œê°„)**
\`\`\`yaml
Backend: [ê¸°ìˆ ] + [ê¸°ìˆ ]
Database: [DB] + [í™•ì¥]
Cache: [ìºì‹œ ì‹œìŠ¤í…œ] (API ì‘ë‹µ ìºì‹±)
Security: [ë³´ì•ˆ ê¸°ìˆ ] + í™˜ê²½ë³€ìˆ˜ ì•”í˜¸í™”
Testing: [í…ŒìŠ¤íŠ¸ ë„êµ¬] + Mock-free 99% ì‹¤ì œ ê²€ì¦
\`\`\`

---

## ğŸ¯ [P1] Task 1.2: [ì¤‘ìš” ê¸°ëŠ¥] (Day 3-4)
[TCREI ë°©ë²•ë¡ ìœ¼ë¡œ ìƒì„¸íˆ ì‘ì„±]

---

## ğŸ¯ [P2] Task 1.3: [ê°œì„  ê¸°ëŠ¥] (Day 5-6)
[ê°„ëµí•˜ê²Œ ì‘ì„±, Phase 2ë¡œ ë¯¸ë£° ìˆ˜ ìˆìŒ]

---

## ğŸ“Š ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### **ì‹œìŠ¤í…œ êµ¬ì¡° ë‹¤ì´ì–´ê·¸ë¨**
\`\`\`mermaid
graph TB
    A[í´ë¼ì´ì–¸íŠ¸] --> B[API Gateway]
    B --> C[ì¸ì¦ ì„œë¹„ìŠ¤]
    B --> D[ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§]
    D --> E[ë°ì´í„°ë² ì´ìŠ¤]
    D --> F[ìºì‹œ ë ˆì´ì–´]
\`\`\`

### **ê¸°ìˆ  ìŠ¤íƒ ìƒì„¸**
**í”„ë¡ íŠ¸ì—”ë“œ**
- í”„ë ˆì„ì›Œí¬: React 18+
- ë¹Œë“œ ë„êµ¬: Vite
- ì–¸ì–´: TypeScript
- UI ë¼ì´ë¸ŒëŸ¬ë¦¬: Shadcn/UI, Tailwind CSS

**ë°±ì—”ë“œ**
- ì„œë²„ë¦¬ìŠ¤: Vercel Functions
- ë°ì´í„°ë² ì´ìŠ¤: Supabase (PostgreSQL)
- ì¸ì¦: Supabase Auth
- ì‹¤ì‹œê°„: Supabase Realtime

---

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

### **ERD (Entity Relationship Diagram)**
\`\`\`mermaid
erDiagram
    USERS ||--o{ IDEAS : creates
    USERS ||--o{ PRDS : generates
    IDEAS ||--o| PRDS : has
    USERS ||--o{ POSTS : writes
    POSTS ||--o{ COMMENTS : has
\`\`\`

### **ì£¼ìš” í…Œì´ë¸” êµ¬ì¡°**
[í•µì‹¬ í…Œì´ë¸”ë§Œ 2-3ê°œ, ìƒì„¸ ìŠ¤í‚¤ë§ˆëŠ” database/schema.sql ì°¸ì¡°]

---

## ğŸ“… ê°œë°œ ì¼ì • (WBS Gantt Chart)

\`\`\`mermaid
gantt
    title ê°œë°œ ì¼ì •
    dateFormat YYYY-MM-DD
    section Phase 1: MVP
    [P0] Task 1.1    :a1, 2024-01-01, 2d
    [P0] Task 1.2    :a2, after a1, 2d
    [P1] Task 1.3    :a3, after a2, 3d
    section Phase 2: í™•ì¥
    [P2] Task 2.1    :b1, after a3, 7d
\`\`\`

---

## âš ï¸ ë¦¬ìŠ¤í¬ ê´€ë¦¬

### **3ëŒ€ í•µì‹¬ ìœ„í—˜**
Risk #1: [ê°€ì¥ í° ê¸°ìˆ ì  ìœ„í—˜]
  - ë¬¸ì œ ì •ì˜
  - ê²€ì¦ ë°©ë²• (êµ¬ì²´ì )
  - ì„±ê³µ ê¸°ì¤€ (ì •ëŸ‰ì  ìˆ˜ì¹˜)
  - ì‹¤íŒ¨ ì‹œ Plan B

Risk #2: [ë‘ ë²ˆì§¸ ìœ„í—˜]
  ...

Risk #3: [ì„¸ ë²ˆì§¸ ìœ„í—˜]
  ...

---

## âœ… ì™„ë£Œ ì¡°ê±´

\`\`\`yaml
âœ… [Expert 1]: [êµ¬ì²´ì  ì™„ë£Œ ì¡°ê±´ + ìˆ˜ì¹˜]
âœ… [Expert 2]: [êµ¬ì²´ì  ì™„ë£Œ ì¡°ê±´ + ìˆ˜ì¹˜]
âœ… QA Expert: Mock-free 99% ê²€ì¦, API ì—ëŸ¬ìœ¨ < 1%
âœ… Integration Expert: 24ì‹œê°„ ì—°ì† ìš´ì˜ ì•ˆì •ì„± í™•ì¸
\`\`\`

---

**âš ï¸ ì¤‘ìš” ê·œì¹™**:
1. ëª¨ë“  Taskì— [P0/P1/P2/P3] ìš°ì„ ìˆœìœ„ í‘œì‹œ í•„ìˆ˜
2. TCREI ë°©ë²•ë¡ ìœ¼ë¡œ ê° Task ì •ì˜
3. 8 Expert System í•¸ë“œì˜¤í”„ ì²´ê³„ ëª…ì‹œ
4. Mock-Free ì›ì¹™ ì¤€ìˆ˜ (MVP 10% ì´í•˜, Full 1% ì´í•˜)
5. ë¶„ëŸ‰ ì œí•œ ì—„ìˆ˜ (MVP 400-600ì¤„, Full 700-1,000ì¤„)
6. ì¤‘ë³µ ë°©ì§€: ë™ì¼ ë‚´ìš© 2íšŒ ì´ìƒ ê¸ˆì§€, Cross-Reference í™œìš©
7. ì½”ë“œ ì˜ˆì‹œëŠ” í•µì‹¬ë§Œ (íŒŒì¼ë‹¹ 20-30ì¤„)
8. Mermaid ë‹¤ì´ì–´ê·¸ë¨ ì ê·¹ í™œìš© (ì‹œìŠ¤í…œ êµ¬ì¡°, ERD, Gantt)
\`\`\`

---

**ì¤‘ìš”**: 
- Planning Expert v6.1 ìˆ˜ì¤€ì˜ ì „ë¬¸ì ì´ê³  ì‹¤ìš©ì ì¸ EPIC ë¬¸ì„œë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.
- TCREI ë°©ë²•ë¡ ê³¼ 8 Expert Systemì„ ì—„ê²©íˆ ì¤€ìˆ˜í•˜ì„¸ìš”.
- ê° Taskì— ìš°ì„ ìˆœìœ„ [P0/P1/P2/P3]ë¥¼ ëª…ì‹œí•˜ì„¸ìš”.
- Mock-Free ì›ì¹™ì„ ì¤€ìˆ˜í•˜ê³  ì‹¤ì œ êµ¬í˜„ ê°€ëŠ¥í•œ ê³„íšì„ ìˆ˜ë¦½í•˜ì„¸ìš”.
- Mermaid ë‹¤ì´ì–´ê·¸ë¨ì„ ì ê·¹ í™œìš©í•˜ì—¬ ì‹œê°í™”í•˜ì„¸ìš”.
- ì‹¤ì œ ê°œë°œì— ë°”ë¡œ í™œìš©í•  ìˆ˜ ìˆë„ë¡ êµ¬ì²´ì ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”.`;
  }

  /**
   * OpenAI API í˜¸ì¶œ
   */
  private async callOpenAI(prompt: string): Promise<string> {
    const apiKey = this.config.apiKey;
    
    if (!apiKey) {
      throw new Error('OpenAI API key is not configured');
    }

    try {
      const response = await fetch('https://api.openai.com/v1/chat/completions', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${apiKey}`,
        },
        body: JSON.stringify({
          model: 'gpt-3.5-turbo', // ë¬´ë£Œ í‹°ì–´ ìµœì í™”
          messages: [
            { 
              role: 'system', 
              content: 'You are a product manager who writes clear and practical PRD documents in Korean. Always respond in markdown format.' 
            },
            { role: 'user', content: prompt },
          ],
          max_tokens: 2000, // ë¹„ìš© ìµœì í™”
          temperature: 0.7,
        }),
      });

      if (!response.ok) {
        const errorData = await response.json().catch(() => ({}));
        throw new Error(`OpenAI API error: ${response.status} ${errorData.error?.message || response.statusText}`);
      }

      const data = await response.json();
      
      if (!data.choices || !data.choices[0] || !data.choices[0].message) {
        throw new Error('Invalid response from OpenAI API');
      }

      return data.choices[0].message.content;
    } catch (error) {
      console.error('OpenAI API call error:', error);
      throw error;
    }
  }

  /**
   * Claude API í˜¸ì¶œ
   */
  private async callClaude(prompt: string): Promise<string> {
    const apiKey = this.config.apiKey;
    
    if (!apiKey) {
      throw new Error('Claude API key is not configured');
    }

    try {
      // Anthropic Claude API í˜¸ì¶œ
      // ì°¸ê³ : ì‹¤ì œ API ì—”ë“œí¬ì¸íŠ¸ì™€ í˜•ì‹ì€ Anthropic ë¬¸ì„œ í™•ì¸ í•„ìš”
      const response = await fetch('https://api.anthropic.com/v1/messages', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'x-api-key': apiKey,
          'anthropic-version': '2023-06-01',
        },
        body: JSON.stringify({
          model: 'claude-3-haiku-20240307', // ë¬´ë£Œ í‹°ì–´ ëª¨ë¸
          max_tokens: 2000,
          messages: [
            {
              role: 'user',
              content: prompt,
            },
          ],
        }),
      });

      if (!response.ok) {
        const errorData = await response.json().catch(() => ({}));
        throw new Error(`Claude API error: ${response.status} ${errorData.error?.message || response.statusText}`);
      }

      const data = await response.json();
      
      if (!data.content || !data.content[0] || !data.content[0].text) {
        throw new Error('Invalid response from Claude API');
      }

      return data.content[0].text;
    } catch (error) {
      console.error('Claude API call error:', error);
      throw error;
    }
  }

  /**
   * OpenRouter API í˜¸ì¶œ (ë¬´ë£Œ ëª¨ë¸ ì‚¬ìš©)
   */
  private async callOpenRouter(prompt: string): Promise<string> {
    const apiKey = this.config.apiKey;
    
    if (!apiKey) {
      throw new Error('OpenRouter API key is not configured');
    }

    // ë¬´ë£Œ ëª¨ë¸ ì„ íƒ (í•˜ë£¨ í• ë‹¹ëŸ‰ ì œê³µ)
    // meta-llama/llama-3.1-8b-instruct: ì•ˆì •ì ì¸ ë¬´ë£Œ ëª¨ë¸ (ê¶Œì¥)
    // mistralai/mistral-7b-instruct: ë¬´ë£Œ ëª¨ë¸
    // google/gemini-flash-1.5-8b: êµ¬ë²„ì „ (ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸ í•„ìš”)
    // google/gemini-2.0-flash-exp: ì‹¤í—˜ì  ëª¨ë¸ (ì‚¬ìš© ë¶ˆê°€)
    const model = this.config.model || 'meta-llama/llama-3.1-8b-instruct';

    try {
      const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${apiKey}`,
          'HTTP-Referer': window.location.origin, // OpenRouter ìš”êµ¬ì‚¬í•­
          'X-Title': 'IdeaSpark', // OpenRouter ìš”êµ¬ì‚¬í•­
        },
        body: JSON.stringify({
          model: model,
          messages: [
            { 
              role: 'system', 
              content: 'You are a product manager who writes clear and practical PRD documents in Korean. Always respond in markdown format.' 
            },
            { role: 'user', content: prompt },
          ],
          max_tokens: 2000, // ë¹„ìš© ìµœì í™”
          temperature: 0.7,
        }),
      });

      if (!response.ok) {
        const errorData = await response.json().catch(() => ({}));
        throw new Error(`OpenRouter API error: ${response.status} ${errorData.error?.message || response.statusText}`);
      }

      const data = await response.json();
      
      if (!data.choices || !data.choices[0] || !data.choices[0].message) {
        throw new Error('Invalid response from OpenRouter API');
      }

      return data.choices[0].message.content;
    } catch (error) {
      console.error('OpenRouter API call error:', error);
      throw error;
    }
  }
}

// AI í´ë¼ì´ì–¸íŠ¸ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
// OpenRouterë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì‚¬ìš© (ë¬´ë£Œ ëª¨ë¸)
const provider = (import.meta.env.VITE_AI_PROVIDER || 'openrouter') as 'openai' | 'claude' | 'openrouter';
const apiKey = provider === 'openrouter'
  ? (import.meta.env.VITE_OPENROUTER_API_KEY || '')
  : provider === 'openai'
  ? (import.meta.env.VITE_OPENAI_API_KEY || '')
  : (import.meta.env.VITE_CLAUDE_API_KEY || '');

export const aiClient = new AIClient({
  provider,
  apiKey,
  model: import.meta.env.VITE_OPENROUTER_MODEL || 'meta-llama/llama-3.1-8b-instruct', // OpenRouter ë¬´ë£Œ ëª¨ë¸
});
